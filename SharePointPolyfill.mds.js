function sharepointpolyfill_mds() { "use strict";function getUrlKeyValue(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o="";null==n&&(n=getCurrentUrl());var a,i=n.indexOf("#");if(i>=0&&(n=n.substr(0,i)),r?(e=e.toLowerCase(),a=n.toLowerCase()):a=n,-1===(i=a.indexOf("&"+e+"="))&&(i=a.indexOf("?"+e+"=")),-1!==i){var l=n.indexOf("&",i+1);-1===l&&(l=n.length),o=n.substring(i+e.length+2,l)}return t?o:decodeURIComponent(o)}function spEncodeURIComponent(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e,a="",i=0;if(void 0===o)return"";for(i=0;i<o.length;i++){var l=o.charCodeAt(i),g=o.charAt(i);if(t&&("#"===g||"?"===g)){a+=o.substr(i);break}if(n&&"&"===g)a+=g;else if(l<=127)r||l>=97&&l<=122||l>=65&&l<=90||l>=48&&l<=57||t&&l>=32&&l<=95&&" \"%<>'&".indexOf(g)<0?a+=g:l<=15?a+="%0"+l.toString(16).toUpperCase():l<=127&&(a+="%"+l.toString(16).toUpperCase());else if(l<=2047)a+="%"+(192|l>>6).toString(16).toUpperCase(),a+="%"+(128|63&l).toString(16).toUpperCase();else if(55296!=(64512&l))a+="%"+(224|l>>12).toString(16).toUpperCase(),a+="%"+(128|(4032&l)>>6).toString(16).toUpperCase(),a+="%"+(128|63&l).toString(16).toUpperCase();else if(i<o.length-1){l=(1023&l)<<10,i++,l|=1023&o.charCodeAt(i),a+="%"+(240|(l+=65536)>>18).toString(16).toUpperCase(),a+="%"+(128|(258048&l)>>12).toString(16).toUpperCase(),a+="%"+(128|(4032&l)>>6).toString(16).toUpperCase(),a+="%"+(128|63&l).toString(16).toUpperCase()}}return a}function stsPageUrlValidation(e){return"http"===(t=e).substr(0,4)||"/"===t.substr(0,1)||-1===t.indexOf(":")?e:(alert("Invalid page URL: "+e),"");var t}function gotoPage(e,t){var n=e.indexOf("?")>=0?"&":"?";if(0===getUrlKeyValue("Source",!0,e).length){var r=t?getUrlKeyValue("Source"):getSource();null!=r&&""!==r&&(t&&(r=spEncodeURIComponent(stsPageUrlValidation(r))),e.length+r.length<=1950&&(e+=n+"Source="+r))}navigate(e)}function getSource(){return spEncodeURIComponent(getSource2(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null))}function getSource2(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=getUrlKeyValue("Source");return""===t&&(t=null!=e&&""!==e?e:getCurrentUrl()),stsPageUrlValidation(t)}function getCurrentUrl(){return window.location.pathname+window.location.search}function getCurrentUrlQuery(){return window.location.search}function navigate(e){e=getAbsoluteUri(e),-1!==getCurrentUrlQuery().indexOf("IsDlg=1")&&(-1!==e.indexOf("?")?"&"!==String(e.match(RegExp("&$")))?e+="&IsDlg=1":e+="IsDlg=1":e+="?IsDlg=1"),window.location.href=stsPageUrlValidation(e)}function getAbsoluteUri(e){var t=document.createElement("a");t.href=e;var n=t.href;return t=null,n}var w=window.w=window;w.GetUrlKeyValue=getUrlKeyValue,w.escapeProperly=spEncodeURIComponent,w.STSPageUrlValidation=stsPageUrlValidation,w.GoToPage=gotoPage,w.Nav={},w.Nav.navigate=navigate; }sharepointpolyfill_mds();